// Guard to redirect to login if no user (uses Supabase auth)
(async function() {
  if (!window.supabase) {
    // If supabase not initialized yet, wait a short time then check
    await new Promise(r => setTimeout(r, 300));
  }
  try {
    const { data } = await window.supabase.auth.getUser();
    const user = data?.user || null;
    if (!user) {
      window.location.replace("../views/Login.html");
    }
  } catch (e) {
    console.warn('Supabase guard error', e);
    // If error, conservative redirect to login
    window.location.replace("../views/Login.html");
  }
})();
